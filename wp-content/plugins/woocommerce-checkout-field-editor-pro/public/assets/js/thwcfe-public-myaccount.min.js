function thwcfeRemoveUploaded(elm,event){thwcfe_public_file_upload.remove_uploaded(elm,event)}var thwcfe_public_base=function($,window,document){"use strict";function remove_duplicates(arr){return arr.filter(function(elem,index,self){return index==self.indexOf(elem)})}function padZero(s,len,c){s=""+s;for(var c=c||"0";s.length<len;)s=c+s;return s}function isInt(value){return!isNaN(value)&&parseInt(Number(value))==value&&!isNaN(parseInt(value,10))}function isEmpty(val){return void 0===val||null==val||val.length<=0}function may_parse_date(dateStr){if(DATE_FORMAT_1.test(dateStr)){var date=new Date(dateStr);if(date)return date}return dateStr}function isInputField(field){if(field&&field.length>0){var tagName=field[0].tagName.toLowerCase();if($.inArray(tagName,["input","select","textarea"])>-1)return!0}return!1}function getInputField(key){var field=null;return key&&(field=$("#"+key),isInputField(field)||(field=$("input[name='"+key+"']"),isInputField(field)||(field=$("input[name='"+key+"[]']"),isInputField(field)||(field=$("input[name='"+key+"[0]']"))))),field}function prepare_date(dateStr,format,strict){var date=null;if(!isEmpty(dateStr))try{date=$.datepicker.parseDate(format,dateStr),date.setHours(0,0,0,0)}catch(err){if(!strict){var pattern=dateStr.split(" "),years=null,months=null,days=null;if(pattern.length>0)for(var i=0;i<pattern.length;i++){var x=pattern[i];x=x.toLowerCase(),-1!=x.indexOf("y")?(x=x.replace(/y/gi,""),years=parseInt(x)):-1!=x.indexOf("m")?(x=x.replace(/m/gi,""),months=parseInt(x)):-1!=x.indexOf("d")&&(x=x.replace(/d/gi,""),days=parseInt(x))}isEmpty(years)&&isEmpty(months)&&isEmpty(days)||(date=new Date,date.setHours(0,0,0,0),years&&0!=years&&date.setFullYear(date.getFullYear()+years),months&&0!=months&&date.setMonth(date.getMonth()+months),days&&0!=days&&date.setDate(date.getDate()+days))}}return date}function compare_dates(field,cvalue){var result=null,value=field.val(),format=field.data("date-format");if(isEmpty(value)||isEmpty(cvalue))return null;var d1=prepare_date(value,format,!0),d2=prepare_date(cvalue,format,!1);if(d1&&d2)try{d1>d2?result=1:d1<d2?result=-1:d1.getTime()===d2.getTime()&&(result=0)}catch(err){result=null}return result}function is_same_date(date1,date2){if(date1&&date2){var day1=date1.getDate(),month1=date1.getMonth()+1,year1=date1.getFullYear(),day2=date2.getDate(),month2=date2.getMonth()+1,year2=date2.getFullYear(),matchYear=!(!isInt(day1)||!isInt(day2)||day1!=day2),matchMonth=!(!isInt(month1)||!isInt(month2)||month1!=month2),matchDay=!(!isInt(year1)||!isInt(year2)||year1!=year2);return matchYear&&matchMonth&&matchDay}return!1}function is_date_eq(field,cvalue){var result=compare_dates(field,cvalue);return null!=result&&0===result}function is_date_gt(field,cvalue){var result=compare_dates(field,cvalue);return null!=result&&1===result}function is_date_lt(field,cvalue){var result=compare_dates(field,cvalue);return null!=result&&-1===result}function is_day_eq(field,cvalue){var result=!1;if(!isEmpty(cvalue)){var value=field.val(),format=field.data("date-format"),date=prepare_date(value,format,!0);if(date){var day=date.getDay();if(isInt(cvalue))cvalue=parseInt(cvalue),result=null!=day&&day===cvalue;else if(cvalue=cvalue.toLowerCase(),$.inArray(cvalue,weekDays)>=0){var daystring=weekDays[day];result=null!=daystring&&daystring===cvalue}}}return result}function setup_enhanced_select(form,class_selector,data){form.find("select."+class_selector).each(function(){var ms=$(this);ms.select2({minimumResultsForSearch:10,allowClear:!0,placeholder:ms.data("placeholder"),maximumSelectionLength:ms.data("maxselections"),language:data.language}).addClass("enhanced")})}function calculate_minutes_from_hr_min(_hour,_min){var minutes=null;return isInt(_hour)&&isInt(_min)&&(minutes=60*_hour+_min),minutes}function get_minutes_from_time_24hr(time){var minutes=null,timeArr=time.split(":");if(2==timeArr.length){minutes=calculate_minutes_from_hr_min(parseInt(timeArr[0]),parseInt(timeArr[1]))}return minutes}function no_specific_days(date,disableDays){var day=date.getDay(),daystring=weekDays[day];return[-1==disableDays.indexOf(daystring),""]}function no_specific_dates(date,datestring){var day=date.getDate(),month=date.getMonth()+1,year=date.getFullYear(),dateArr=datestring.split("-");if(3==dateArr.length){var matchYear=!isInt(dateArr[0])||dateArr[0]==year,matchMonth=!isInt(dateArr[1])||dateArr[1]==month,matchDay=!isInt(dateArr[2])||dateArr[2]==day;return isInt(dateArr[0])||isInt(dateArr[1])||isInt(dateArr[2])?[!(matchYear&&matchMonth&&matchDay),""]:[!0,""]}if(LINKED_DATE_FORMAT.test(datestring)){var sd=get_linked_datepicker_selected_date(datestring,"disabled");return sd?[!is_same_date(date,sd),""]:[!0,""]}var _now=new Date;if(is_same_date(date,_now)){var _hour=_now.getHours(),_min=_now.getMinutes(),op="eq";-1!=datestring.indexOf("+")?(op="gt",datestring=datestring.replace("+","")):-1!=datestring.indexOf("-")&&(op="lt",datestring=datestring.replace("-",""));var _minutes=calculate_minutes_from_hr_min(_hour,_min),minutes=get_minutes_from_time_24hr(datestring);if(isInt(minutes)&&isInt(_minutes)&&("eq"===op&&_minutes==minutes||"gt"===op&&_minutes>minutes||"lt"===op&&_minutes<minutes))return[!1,""]}return[!0,""]}function disable_dates(date){var disabledDays=$(this).data("disabled-days");if(disabledDays&&disabledDays.length>0){var daysArr=disabledDays.split(","),disabledDay=no_specific_days(date,daysArr);if(!disabledDay[0])return disabledDay}var disabledDates=$(this).data("disabled-dates");if(disabledDates&&disabledDates.length>0){var datesArr=disabledDates.split(",");if(datesArr.length>0)for(var i=0;i<datesArr.length;i++){var disabledDate=no_specific_dates(date,datesArr[i].trim());if(!disabledDate[0])return disabledDate}}return[!0,""]}function get_linked_datepicker_selected_date(dateStr,option){var sd=null;if(LINKED_DATE_FORMAT.test(dateStr)){var linkedDate=dateStr.replace(/[{}]/g,"");if(linkedDate){var dp=$("#"+linkedDate);dp.length&&(sd=dp.datepicker("getDate"))}}return sd}function check_if_linked_date(dateStr,targetDp,option){if(LINKED_DATE_FORMAT.test(dateStr)){var linkedDate=dateStr.replace(/[{}]/g,"");if(linkedDate){var dp=$("#"+linkedDate);dp.length&&dp.datepicker("option","onSelect",function(dateText,inst){if("minDate"===option){var df=dp.data("date-format"),dpDate=prepare_date(dateText,df,!0),nextDate=new Date(dpDate.getTime()+864e5);targetDp.datepicker("option","minDate",nextDate)}else"maxDate"===option&&targetDp.datepicker("option","maxDate",dp.datepicker("getDate"))})}dateStr=""}return dateStr}function setup_date_picker(form,class_selector,data){form.find("."+class_selector).each(function(){var dateFormat=$(this).data("date-format"),defaultDate=$(this).data("default-date"),maxDate=$(this).data("max-date"),minDate=$(this).data("min-date"),yearRange=$(this).data("year-range"),numberOfMonths=$(this).data("number-months"),firstDay=$(this).data("first-day");maxDate=may_parse_date(maxDate),minDate=may_parse_date(minDate),maxDate=check_if_linked_date(maxDate,$(this),"maxDate"),minDate=check_if_linked_date(minDate,$(this),"minDate"),dateFormat=""==dateFormat?"dd/mm/yy":dateFormat,defaultDate=""==defaultDate?null:defaultDate,maxDate=""==maxDate?null:maxDate,minDate=""==minDate?null:minDate,yearRange=""==yearRange?"-100:+1":yearRange,numberOfMonths=numberOfMonths>0?numberOfMonths:1;var value=$(this).val();value.trim()&&(defaultDate=value),$(this).datepicker({defaultDate:defaultDate,maxDate:maxDate,minDate:minDate,yearRange:yearRange,numberOfMonths:numberOfMonths,showButtonPanel:!0,changeMonth:!0,changeYear:!0}),$(this).datepicker("option",$.datepicker.regional[data.language]),$(this).datepicker("option","dateFormat",dateFormat),$(this).datepicker("option","beforeShowDay",disable_dates),$(this).datepicker("option","firstDay",firstDay),$(this).datepicker("setDate",defaultDate),data.readonly_date_field&&$(this).prop("readonly",!0)}),data.notranslate_dp&&$(".ui-datepicker").addClass("notranslate")}function setup_time_picker_linked_date(form,class_selector,data){$("."+class_selector).change(function(){var dp=$(this),tp=$(".thwcfe-linked-date-"+dp.prop("id"));tp.length&&adjust_time_slots_based_on_date_selected(dp,tp,data)})}function split_hour_min(hourMinStr){var hours=0,minutes=0;if(hourMinStr&&("string"==typeof hourMinStr||hourMinStr instanceof String)){var _hourMin=hourMinStr.split(" ");if(_hourMin.length>0)for(var i=0;i<_hourMin.length;i++){var x=_hourMin[i];x=x.toLowerCase(),-1!=x.indexOf("h")?(x=x.replace(/h/gi,""),hours=parseInt(x)):-1!=x.indexOf("m")&&(x=x.replace(/m/gi,""),minutes=parseInt(x))}hours=hours||0,minutes=minutes||0,minutes>=60&&(hours+=1,minutes=0)}return[hours,minutes]}function get_start_hr_min(startTime){var timeInfo={};if(startTime){var startTimeArr=split_hour_min(startTime);if(startTimeArr.length>1){var currTime=new Date,currHour=currTime.getHours(),currMin=currTime.getMinutes(),_startHour=startTimeArr[0],startDays=parseInt(_startHour/24),startDate=new Date;startDate.addDays(startDays).setHours(0,0,0,0);var startHour=_startHour%24,startMin=startTimeArr[1];startHour=currHour+startHour,startMin=currMin+startMin,startMin>=60?(startHour++,startMin-=60):startMin<0&&(startHour--,startMin=60+startMin),timeInfo.startDate=startDate,timeInfo.startDays=startDays,timeInfo.startHour=startHour,timeInfo.startMin=startMin,timeInfo.hour=startTimeArr[0],timeInfo.min=startTimeArr[1]}}return timeInfo}function get_time_suffix(time){var suffix="";return time&&(time=time.toLowerCase(),-1!=time.indexOf("am")?suffix="am":-1!=time.indexOf("pm")&&(suffix="pm")),suffix}function split_time_string(time,ampm){time=time.replace(/pm/gi,""),time=time.replace(/am/gi,"");var timeArr=time.split(":"),hours=parseInt(timeArr[0]),minutes=parseInt(timeArr[1]);return"pm"==ampm&&hours<12?hours+=12:"am"==ampm&&12==hours&&(hours-=12),[hours,minutes]}function split_time_string_12hr(time){return split_time_string(time,get_time_suffix(time))}function get_disabled_time_ranges(minTime,maxTime,startTime){var minHour=minTime[0],minMin=minTime[1],currTime=(maxTime[0],maxTime[1],new Date);currTime.getHours(),currTime.getMinutes();currTime.setSeconds(0,0);var startHour=startTime.startHour,startMin=startTime.startMin;return(new Date).setHours(startHour,startMin,0,0),minHour=padZero(minHour,2),minMin=padZero(minMin,2),startHour=padZero(startHour,2),startMin=padZero(startMin,2),[[minHour+":"+minMin,startHour+":"+startMin]]}function disable_all_time_slots(tp,minTime,maxTime){var suffixMaxTime=get_time_suffix(maxTime),maxTimeArr=split_time_string(maxTime,suffixMaxTime),maxHour=maxTimeArr[0],maxMin=maxTimeArr[1];maxHour=padZero(maxHour,2),maxMin=padZero(parseInt(maxMin)+1,2);var newMaxTime=maxHour+":"+maxMin;tp.timepicker("option","disableTimeRanges",[[minTime,newMaxTime]])}function adjust_time_slots_based_on_date_selected(dp,tp,data){var dpDate=null;if(dp){var df=dp.data("date-format");dpDate=prepare_date(dp.val(),df,!0)}var minTime=tp.data("min-time"),maxTime=tp.data("max-time"),startTime=tp.data("start-time"),startTimeArr=get_start_hr_min(startTime);if(startTimeArr){var startDate=startTimeArr.startDate;if(null!=dp&&dpDate<startDate)disable_all_time_slots(tp,minTime,maxTime);else if(null!=dp&&dpDate>startDate)tp.timepicker("option","disableTimeRanges",[]);else{var minTimeArr=split_time_string_12hr(minTime),minHour=minTimeArr[0],minMin=minTimeArr[1],maxTimeArr=split_time_string_12hr(maxTime),maxHour=maxTimeArr[0],maxMin=maxTimeArr[1],startHour=startTimeArr.startHour,startMin=startTimeArr.startMin;if(startHour>maxHour||startHour==maxHour&&startMin>maxMin)if(data.restrict_time_slots_for_same_day)disable_all_time_slots(tp,minTime,maxTime);else{var disabledTimeRanges=get_disabled_time_ranges(minTimeArr,maxTimeArr,startTimeArr);tp.timepicker("option","disableTimeRanges",disabledTimeRanges)}else if(startHour<minHour||startHour==minHour&&startMin<minMin)tp.timepicker("option","disableTimeRanges",[]);else{var disabledTimeRanges=get_disabled_time_ranges(minTimeArr,maxTimeArr,startTimeArr);tp.timepicker("option","disableTimeRanges",disabledTimeRanges)}}}}function setup_time_picker(form,class_selector,data){form.find("."+class_selector).each(function(){var minTime=$(this).data("min-time"),maxTime=$(this).data("max-time"),step=$(this).data("step"),format=$(this).data("format"),linkedDate=($(this).data("start-time"),$(this).data("linked-date"));minTime=minTime||"12:00am",maxTime=maxTime||"11:30pm",step=step||"30",format=format||"h:i A";var args={minTime:minTime,maxTime:maxTime,step:step,timeFormat:format,forceRoundTime:!0,disableTextInput:!0,disableTouchKeyboard:!0,lang:data.lang};if($(this).timepicker(args),linkedDate){var dp=$("#"+linkedDate);dp.length&&adjust_time_slots_based_on_date_selected(dp,$(this),data)}else adjust_time_slots_based_on_date_selected(null,$(this),data)})}function display_char_count(elm,isCount){var fid=elm.prop("id"),len=elm.val().length,displayElm=$("#"+fid+"-char-count");if(isCount)displayElm.text("("+len+" characters)");else{var maxLen=elm.prop("maxlength"),left=maxLen-len;displayElm.text("("+left+" characters left)"),rem<0&&displayElm.css("color","red")}}function set_field_value_by_elm(elm,type,value){switch(type){case"radio":elm.val([value]);break;case"checkbox":1==elm.data("multiple")?(value=value||[],elm.val(value)):elm.val([value]);break;case"select":elm.prop("multiple")?elm.val(value):elm.val([value]);break;default:elm.val(value)}}function get_field_value(type,elm,name){var value="";switch(type){case"radio":value=$("input[type=radio][name='"+name+"']:checked").val();break;case"checkbox":if(1==elm.data("multiple")){var valueArr=[];$("input[type=checkbox][name='"+name+"[]']:checked").each(function(){valueArr.push($(this).val())}),value=valueArr}else value=$("input[type=checkbox][name='"+name+"']:checked").val();break;case"select":case"multiselect":default:value=elm.val()}return value}function get_field_name(type,name,id,multiple){return"checkbox"==type&&multiple?name=name.replace("[]",""):"select"==type&&multiple&&(name=id),name}var LINKED_DATE_FORMAT=/^{[a-z\_]+[a-z0-9\_]*}$/,DATE_FORMAT_1=/^(19|20)\d{2}-(0?[1-9]|1[0-2])-(0?[1-9]|1\d|2\d|3[01])$/,weekDays=["sun","mon","tue","wed","thu","fri","sat"];return Date.prototype.addDays=function(days){return this.setDate(this.getDate()+parseInt(days)),this},$.fn.getType=function(){try{return"INPUT"==this[0].tagName?this[0].type.toLowerCase():this[0].tagName.toLowerCase()}catch(err){return"E001"}},$(".thwcfe-char-count").keyup(function(){display_char_count($(this),!0)}),$(".thwcfe-char-left").keyup(function(){display_char_count($(this),!1)}),{setup_enhanced_select:setup_enhanced_select,setup_date_picker:setup_date_picker,setup_time_picker:setup_time_picker,setup_time_picker_linked_date:setup_time_picker_linked_date,display_char_count:display_char_count,remove_duplicates:remove_duplicates,set_field_value_by_elm:set_field_value_by_elm,get_field_value:get_field_value,get_field_name:get_field_name,isInputField:isInputField,getInputField:getInputField,is_date_eq:is_date_eq,is_date_gt:is_date_gt,is_date_lt:is_date_lt,is_day_eq:is_day_eq}}(window.jQuery,window,document),thwcfe_public_conditions=function($,window,document){"use strict";function hide_section(celm,validations,needSetup){celm.hide();var sid=celm.prop("id");celm.addClass("thwcfe-disabled-section"),celm.find(".thwcfe-input-field-wrapper").length&&celm.find(".thwcfe-input-field-wrapper").each(function(){var validations=$(this).data("validations");disable_field_validations($(this),validations)});var disabled_snames=$("#thwcfe_disabled_sections").val(),disabled_snames_x=disabled_snames?disabled_snames.split(","):[];disabled_snames_x.push(sid),disabled_snames=disabled_snames_x.toString(),$("#thwcfe_disabled_sections").val(disabled_snames),enable_disable_price_fields(celm,!1,!needSetup)}function show_section(celm,validations,needSetup){celm.show();var sid=celm.prop("id");celm.removeClass("thwcfe-disabled-section"),celm.find(".thwcfe-input-field-wrapper").length&&celm.find(".thwcfe-input-field-wrapper:not(.thwcfe-disabled-field-wrapper)").each(function(){var validations=$(this).data("validations");disable_field_validations($(this),validations)});var disabled_snames=$("#thwcfe_disabled_sections").val(),disabled_snames_x=disabled_snames?disabled_snames.split(","):[];disabled_snames_x=jQuery.grep(disabled_snames_x,function(value){return value!=sid}),disabled_snames=disabled_snames_x.toString(),$("#thwcfe_disabled_sections").val(disabled_snames),enable_disable_price_fields(celm,!0,!needSetup)}function hide_field(cfield,validations,needSetup){var cinput=cfield.find(":input.thwcfe-input-field");"hidden"===cfield.getType()&&(cinput=cfield);var ftype=cinput.getType(),fid=cinput.prop("id");"radio"==ftype?fid=cinput.prop("name"):"checkbox"==ftype&&(fid=cinput.prop("name"),fid=fid.replace("[]","")),cinput.data("current-value",thwcfe_public_base.get_field_value(ftype,cinput,fid)),cfield.hide(),thwcfe_public_base.set_field_value_by_elm(cinput,ftype,""),cinput.addClass("thwcfe-disabled-field"),cfield.addClass("thwcfe-disabled-field-wrapper");var change_event_disabled_fields=thwcfe_public_var.change_event_disabled_fields,change_e_disabled_fields=change_event_disabled_fields?change_event_disabled_fields.split(","):[];-1===$.inArray(fid,change_e_disabled_fields)&&cinput.change(),"E001"==ftype&&cfield.attr("data-name")&&(fid=cfield.data("name"));var disabled_fnames=$("#thwcfe_disabled_fields").val(),disabled_fnames_x=disabled_fnames?disabled_fnames.split(","):[];disabled_fnames_x.push(fid),disabled_fnames=disabled_fnames_x.toString(),$("#thwcfe_disabled_fields").val(disabled_fnames),disable_field_validations(cfield,validations)}function show_field(cfield,validations,needSetup){var cinput=cfield.find(":input.thwcfe-input-field");"hidden"===cfield.getType()&&(cinput=cfield);var ftype=cinput.getType(),fid=cinput.prop("id");"radio"==ftype&&(fid=cinput.prop("name")),"checkbox"==ftype&&(fid=cinput.prop("name"),fid=fid.replace("[]","")),cfield.show();var fval=cinput.data("current-value");fval&&thwcfe_public_base.set_field_value_by_elm(cinput,ftype,fval),cfield.removeClass("thwcfe-disabled-field-wrapper"),cinput.removeClass("thwcfe-disabled-field");var change_event_disabled_fields=thwcfe_public_var.change_event_disabled_fields,change_e_disabled_fields=change_event_disabled_fields?change_event_disabled_fields.split(","):[];-1===$.inArray(fid,change_e_disabled_fields)&&cinput.change();var disabled_fnames=$("#thwcfe_disabled_fields").val(),disabled_fnames_x=disabled_fnames?disabled_fnames.split(","):[];"E001"==ftype&&cfield.attr("data-name")&&(fid=cfield.data("name")),disabled_fnames_x=jQuery.grep(disabled_fnames_x,function(value){return value!=fid}),disabled_fnames=disabled_fnames_x.toString(),$("#thwcfe_disabled_fields").val(disabled_fnames),enable_field_validations(cfield,validations)}function hide_elm(elm,validations,needSetup){"section"===elm.data("rules-elm")?hide_section(elm,validations,needSetup):hide_field(elm,validations,needSetup)}function show_elm(elm,validations,needSetup){"section"===elm.data("rules-elm")?show_section(elm,validations,needSetup):show_field(elm,validations,needSetup)}function disable_field_validations(elm,validations){validations&&(elm.removeClass(validations),elm.removeClass("woocommerce-validated woocommerce-invalid woocommerce-invalid-required-field"))}function enable_field_validations(elm,validations){elm.removeClass("woocommerce-validated woocommerce-invalid woocommerce-invalid-required-field"),validations&&elm.addClass(validations)}function enable_disable_price_fields(wrapper,enable,trigger_price_calc){var price_fields=wrapper.find(".thwcfe-price-field");price_fields.length&&(enable?price_fields.removeClass("thwcfe-disabled-shipping-field"):price_fields.addClass("thwcfe-disabled-shipping-field"),trigger_price_calc&&thwcfe_public_price.calculate_extra_cost(thwcfe_public_var))}function validate_condition(condition,valid,needSetup,cfield){if(condition){var operand_type=condition.operand_type,operand=condition.operand,operator=condition.operator,cvalue=condition.value;"field"===operand_type&&operand&&jQuery.each(operand,function(){var field=thwcfe_public_base.getInputField(this);if(thwcfe_public_base.isInputField(field)){var ftype=field.getType(),value=thwcfe_public_base.get_field_value(ftype,field,this);if("empty"===operator&&""!=value)valid=!1;else if("not_empty"===operator&&""==value)valid=!1;else if("value_eq"===operator&&value!=cvalue)valid=!1;else if("value_ne"===operator&&value==cvalue)valid=!1;else if("value_gt"===operator)valid=!(!$.isNumeric(value)||!$.isNumeric(cvalue))&&(!(Number(value)<=Number(cvalue))&&valid);else if("value_le"===operator)valid=!(!$.isNumeric(value)||!$.isNumeric(cvalue))&&(!(Number(value)>=Number(cvalue))&&valid);else if("date_eq"!==operator||thwcfe_public_base.is_date_eq(field,cvalue))if("date_ne"===operator&&thwcfe_public_base.is_date_eq(field,cvalue))valid=!1;else if("date_gt"!==operator||thwcfe_public_base.is_date_gt(field,cvalue))if("date_lt"!==operator||thwcfe_public_base.is_date_lt(field,cvalue))if("day_eq"!==operator||thwcfe_public_base.is_day_eq(field,cvalue)){if("day_ne"===operator&&thwcfe_public_base.is_day_eq(field,cvalue))valid=!1;else if("checked"===operator){var checked=field.prop("checked");valid=!!checked&&valid}else if("not_checked"===operator){var checked=field.prop("checked");valid=!checked&&valid}}else valid=!1;else valid=!1;else valid=!1;else valid=!1;if(needSetup){var depFields=field.data("fields");if(depFields){var depFieldsArr=depFields.split(",");depFieldsArr.push(cfield.prop("id")),depFields=depFieldsArr.toString()}else depFields=cfield.prop("id");field.data("fields",depFields),add_field_value_change_handler(field)}}})}return valid}function validate_field_condition(cfield,needSetup){var conditionalRules=cfield.data("rules"),conditionalRulesAction=cfield.data("rules-action"),validations=cfield.data("validations"),valid=!0;if(conditionalRules){try{jQuery.each(conditionalRules,function(){var ruleSet=this;jQuery.each(ruleSet,function(){var rule=this,validRS=!1;jQuery.each(rule,function(){var conditions=this,validCS=!0;jQuery.each(conditions,function(){validCS=validate_condition(this,validCS,needSetup,cfield)}),validRS=validRS||validCS}),valid=valid&&validRS})})}catch(err){alert(err)}"hide"===conditionalRulesAction?valid?hide_elm(cfield,validations,needSetup):show_elm(cfield,validations,needSetup):valid?show_elm(cfield,validations,needSetup):hide_elm(cfield,validations,needSetup)}}function conditional_field_value_change_listner(event){var depFields=$(this).data("fields"),depFieldsArr=depFields.split(",");depFieldsArr=thwcfe_public_base.remove_duplicates(depFieldsArr),jQuery.each(depFieldsArr,function(){if(this.length>0){validate_field_condition($("#"+this),!1)}})}function add_field_value_change_handler(field){field.off("change",conditional_field_value_change_listner),field.on("change",conditional_field_value_change_listner)}function validate_all_conditions(wrapper){wrapper?(wrapper.find(".thwcfe-conditional-field").each(function(){validate_field_condition($(this),!0)}),wrapper.find(".thwcfe-conditional-section").each(function(){validate_field_condition($(this),!0)})):($(".thwcfe-conditional-field").each(function(){validate_field_condition($(this),!0)}),$(".thwcfe-conditional-section").each(function(){validate_field_condition($(this),!0)}))}function prepare_shipping_conitional_fields(elm,trigger_price_calc){var ship_to_different_address=$("#ship-to-different-address-checkbox");enable_disable_price_fields($(".woocommerce-shipping-fields"),ship_to_different_address.is(":checked"),trigger_price_calc)}return{validate_field_condition:validate_field_condition,validate_all_conditions:validate_all_conditions,prepare_shipping_conitional_fields:prepare_shipping_conitional_fields}}(window.jQuery,window,document),thwcfe_public_file_upload=function($,window,document){"use strict";function setup_file_upload(wrapper,data){wrapper.find(".thwcfe-checkout-file").on("change",upload_file)}function upload_file(event){var files=event.target.files,wrapper=($("#"+event.target.id).parent(),$(this).closest(".thwcfe-input-field-wrapper")),input=wrapper.find(".thwcfe-checkout-file-value"),field_name=input.attr("name"),data=new FormData;data.append("action","thwcfe_file_upload"),data.append("field_name",field_name),$.each(files,function(key,value){data.append("file",value)}),$.ajax({type:"POST",url:thwcfe_public_var.ajax_url,data:data,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(){wrapper.find(".thwcfe-file-upload-status").show(),input.val(""),clear_message(wrapper)}}).done(function(data,textStatus,jqXHR){if("SUCCESS"==data.response){var uploaded=data.uploaded;input.val(JSON.stringify(uploaded));var remove_btn=wrapper.find(".thwcfe-remove-uploaded");remove_btn.data("file",uploaded.file),remove_btn.show();var prev_html=uploaded.name;wrapper.find(".thwcfe-upload-preview").html(prev_html),wrapper.find(".thwcfe-uloaded-files").show(),wrapper.find(".thwcfe-checkout-file").hide()}else add_message(wrapper,data,"error"),clean_file_input(wrapper)}).fail(function(jqXHR,textStatus,error){add_message(wrapper,data,"error"),clean_file_input(wrapper)}).always(function(){wrapper.find(".thwcfe-file-upload-status").hide()})}function remove_uploaded(elm,event){var wrapper=$(elm).closest(".thwcfe-input-field-wrapper"),file=$(elm).data("file"),data={action:"thwcfe_remove_uploaded",file:file};$.ajax({type:"POST",url:thwcfe_public_var.ajax_url,data:data,cache:!1,dataType:"json",beforeSend:function(){wrapper.find(".thwcfe-uloaded-files").hide(),wrapper.find(".thwcfe-file-upload-status").show(),clear_message(wrapper)}}).done(function(data,textStatus,jqXHR){console.log(data),"SUCCESS"==data.response?($(elm).data("file",""),$(elm).hide(),wrapper.find(".thwcfe-upload-preview").html(""),wrapper.find(".thwcfe-uloaded-files").hide(),wrapper.find(".thwcfe-checkout-file").show(),clean_file_input(wrapper),add_message(wrapper,data,"success")):"ERROR"==data.response&&add_message(wrapper,data,"error")}).fail(function(jqXHR,textStatus,error){wrapper.find(".thwcfe-uloaded-files").show(),add_message(wrapper,error,"error")}).always(function(){wrapper.find(".thwcfe-file-upload-status").hide()})}function clean_file_input(wrapper){wrapper.find(".thwcfe-checkout-file").val(""),wrapper.find(".thwcfe-checkout-file-value").val("")}function add_message(wrapper,data,type){data.response&&data.error?(wrapper.find(".thwcfe-file-upload-msg").html(data.error),wrapper.find(".thwcfe-file-upload-msg").show()):clear_message(wrapper)}function clear_message(wrapper){wrapper.find(".thwcfe-file-upload-msg").html(""),wrapper.find(".thwcfe-file-upload-msg").hide()}return{setup_file_upload:setup_file_upload,remove_uploaded:remove_uploaded}}(window.jQuery,window,document),thwcfe_public_price=function($,window,document){"use strict";function setup_price_fields(wrapper,data){prepare_extra_cost_for_option_fields(wrapper),wrapper.find(".thwcfe-price-field").change(function(){var ftype=$(this).getType();return"select"!=ftype&&"radio"!=ftype||prepare_extra_cost_from_selected_option($(this),ftype),calculate_extra_cost(data),!1})}function prepare_extra_cost_for_option_fields(wrapper){wrapper.find(".thwcfe-price-option-field").each(function(){prepare_extra_cost_from_selected_option($(this),"select")})}function prepare_extra_cost_from_selected_option(elm,ftype){var option=elm.find(":selected"),oPrice="",oPriceType="";elm.attr("multiple")?elm.find("option:selected").each(function(){var oprice=$(this).data("price"),opriceType=$(this).data("price-type");oprice&&(opriceType=opriceType||"normal",oPrice.trim()&&(oPrice+=","),oPriceType.trim()&&(oPriceType+=","),oPrice+=oprice,oPriceType+=opriceType)}):(oPrice=option.data("price"),oPriceType=option.data("price-type"),oPriceType=oPriceType||"normal"),oPrice?(elm.data("price",oPrice),elm.data("price-type",oPriceType)):"select"==ftype&&(elm.data("price",""),elm.data("price-type",""))}function prepare_price_props_for_multiple_options(elm,type,options){var oPrice="",oPriceType="";return options.each(function(){var oprice=$(this).data("price"),opriceType=$(this).data("price-type");oprice&&(opriceType=opriceType||"normal",oPrice.trim()&&(oPrice+=","),oPriceType.trim()&&(oPriceType+=","),oPrice+=oprice,oPriceType+=opriceType)}),{price:oPrice,priceType:oPriceType}}function prepare_price_props_for_multiple_option_field(elm,name,type){var price_props=!1;if("select"===type){var options=elm.find("option:selected");price_props=prepare_price_props_for_multiple_options(elm,type,options)}else if("checkbox"===type){var options=$("input[type=checkbox][name='"+name+"[]']:checked");price_props=prepare_price_props_for_multiple_options(elm,type,options)}return price_props}function calculate_extra_cost(args){var priceInfoArr={};$(".thwcfe-price-field:not(.thwcfe-disabled-field)").each(function(){if(!$(this).hasClass("thwcfe-disabled-field")&&!$(this).hasClass("thwcfe-disabled-shipping-field")){var ftype=$(this).getType(),multiple=0;"checkbox"==ftype?multiple=$(this).data("multiple"):"select"==ftype&&$(this).attr("multiple")&&(multiple=1);var id=$(this).prop("id"),name=thwcfe_public_base.get_field_name(ftype,$(this).prop("name"),id,multiple),value=thwcfe_public_base.get_field_value(ftype,$(this),name);"radio"===ftype&&(value=$(this).is(":checked")?value:"");var label=$(this).data("price-label"),qtyField="",price=$(this).data("price"),priceType=$(this).data("price-type"),priceUnit=$(this).data("price-unit"),taxable=$(this).data("taxable"),tax_class=$(this).data("tax_class");if("checkbox"===ftype&&multiple){var price_props=prepare_price_props_for_multiple_option_field($(this),name,ftype);price_props&&(price=price_props.price,priceType=price_props.priceType)}if(priceType&&"dynamic"===priceType?!$.isNumeric(priceUnit)&&$("#"+priceUnit).length&&(qtyField=$("#"+priceUnit).val(),priceUnit=1):priceUnit=0,value&&name&&(price||priceType&&"custom"===priceType)){var priceInfo={};priceInfo.name=name,priceInfo.label=label,priceInfo.price=price,priceInfo.price_type=priceType,priceInfo.price_unit=priceUnit,priceInfo.value=value,priceInfo.qty_field=qtyField,priceInfo.taxable=taxable,priceInfo.tax_class=tax_class,priceInfo.multiple=multiple,priceInfoArr[name]=priceInfo}}});var data={action:"thwcfe_calculate_extra_cost",price_info:JSON.stringify(priceInfoArr)};$(".thwcfe-price-field").length&&(currRequest=$.ajax({type:"POST",url:args.ajax_url,data:data,beforeSend:function(){null!=currRequest&&currRequest.abort()},success:function(code){$("body").trigger("update_checkout")}}))}var currRequest=null;return{setup_price_fields:setup_price_fields,calculate_extra_cost:calculate_extra_cost}}(window.jQuery,window,document);!function($){"use strict";!function(){var form_wrapper=$(".woocommerce-MyAccount-content");form_wrapper&&(thwcfe_public_base.setup_enhanced_select(form_wrapper,"thwcfe-enhanced-select",thwcfe_public_var),thwcfe_public_base.setup_enhanced_select(form_wrapper,"thwcfe-enhanced-multi-select",thwcfe_public_var),thwcfe_public_base.setup_date_picker(form_wrapper,"thwcfe-checkout-date-picker",thwcfe_public_var),thwcfe_public_base.setup_time_picker(form_wrapper,"thwcfe-checkout-time-picker",thwcfe_public_var),thwcfe_public_base.setup_time_picker_linked_date(form_wrapper,"thwcfe-checkout-date-picker",thwcfe_public_var),thwcfe_public_conditions.validate_all_conditions(null))}()}(jQuery);